---
title: "Introdução à análise geoespacial com R <br><br><br>"
subtitle: "6 Estrutura e manipulação de dados vetoriais <br><br><br>"
author: "Maurício H. Vancine <br> Milton C. Ribeiro"
date: "22/10/2020"
output:
  xaringan::moon_reader:
    css: [metropolis, metropolis-fonts]
    lib_dir: libs
    nature:
      highlightStyle: rainbow
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE, encoding = "UTF-8")
knitr::opts_chunk$set(fig.retina = 3, fig.align='center', warning = FALSE, message = FALSE)
if(!require(emo)) devtools::install_github("hadley/emo")
if(!require(sf)) install.packages("sf")
if(!require(tidyverse)) install.packages("tidyverse")
if(!require(geobr)) install.packages("geobr")
if(!require(rnaturalearth)) install.packages("rnaturalearth")
```

class: clear
background-image: url(img/geo_vector_sf_allison.png)
background-size: 800px

<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

Fonte: [@allison_horst](https://twitter.com/allison_horst)

---

background-image: url(img/r_spatial.jpeg)
background-size: 350px
background-position: 80% 65%

# 6 Estrutura e manipulação de vetores

## Tópicos
1. Pacotes
1. Geometrias sf
1. Classes sf
1. Importar dados vetoriais
1. Descrição de objetos sf
1. Converter dados para sf
1. Converter CRS
1. Operações de atributos
1. Operações espaciais
1. Operações geométricas
1. Exportar dados vetoriais

---

# 6 Estrutura e manipulação de vetores

## Script

<br><br><br><br>

## .center[`06_script_intro_geocomp_r.R`]

---

background-image: url(img/geo_sp_dep.png)
background-size: 700px
background-position: 50% 65%

# 6.1 Pacotes

## Pacote sp

```{r eval=FALSE}
# sp
install.packages("sp")
library(sp)
```

<br><br><br><br><br><br><br><br><br><br><br>

[*] https://github.com/edzer/sp/

---

background-image: url(img/package_sf.gif)
background-size: 350px
background-position: 50% 70%

# 6.1 Pacotes

## Pacote sf

```{r eval=FALSE}
# sf
install.packages("sf")
library(sf)
```

<br><br><br><br><br><br><br><br><br><br><br>

[*] https://r-spatial.github.io/sf/

---

background-image: url(img/cheatsheet_sf.png)
background-size: 500px
background-position: 50% 60%

# 6.1 Pacotes

## Pacote sf

### Cheatsheets

<br><br><br><br><br><br><br><br><br><br><br><br><br>

[*] https://raw.githubusercontent.com/rstudio/cheatsheets/master/sf.pdf

---

background-image: url(img/geo_sf_article.png)
background-size: 500px
background-position: 50% 85%

# 6.1 Pacotes

## Pacote sf

### Artigo
> - Pebesma, Edzer. ["Simple Features for R: Standardized Support for Spatial Vector Data."](https://journal.r-project.org/archive/2018/RJ-2018-009/) The R Journal 10.01 (2018): 439-446.

---

background-image: url(img/geo_sf_deps.png)
background-size: 700px
background-position: 50% 85%

# 6.1 Pacotes

## Pacote sf

### Dependências de outros pacotes

---

background-image: url(img/geo_sf_methods.png)
background-size: 600px
background-position: 50% 80%

# 6.1 Pacotes

## Pacote sf

### Métodos

---

background-image: url(img/geo_sf_functions.png)
background-size: 700px
background-position: 50% 70%

# 6.1 Pacotes

## Pacote sf

### Funções

---

# 6.1 Pacotes

## Pacote sf

### **Rápida importação e exportação** de dados

--

### **Desempenho aprimorado** de mapas e gráficos

--

### Objetos `sf` podem ser tratados como `data frames` (`tibbles`) na maioria das **operações de manipulação**

--

### As funções `sf` **podem ser combinadas** usando o operador `%>%` e funcionam bem com `tidyverse`

--

### Os nomes das funções sf são relativamente **consistentes e intuitivos** (todos começam com `sf::st_`)

---

background-image: url(img/geo_vector_data.png)
background-size: 500px
background-position: 45% 80%

# 6.2 Tipos de geometrias sf

## Tipos de dados geoespaciais vetoriais

---

background-image: url(img/geo_vector_sf_types.png)
background-size: 500px
background-position: 50% 80%

# 6.2 Tipos de geometrias sf

## Tipos de geometrias

---

# 6.3 Classes sf

## Simple feature geometries (sfg)

### A classe `sfg` representa os **diferentes tipos de geometrias** no R: ponto, linha, polígono (e seus equivalentes ‘multi’) ou coleção de geometrias

--

#### Funções para criar geometrias da classe `sfg`:

```{r}
# simple
sf::st_point()
sf::st_linestring()
sf::st_polygon()

# multi
sf::st_multipoint()
sf::st_multilinestring()
sf::st_multipolygon()

# collections
sf::st_geometrycollection()
```

---

# 6.3 Classes sf

## Simple feature geometries (sfg)

### Os objetos `sfg` podem ser **criados** a partir de **três tipos de dados R base**:

<br>

### 1. **vetor numérico**: um único ponto
### 2. **matriz**: um conjunto de pontos, onde cada linha representa um ponto, um multiponto ou uma linha
### 3. **lista**: uma coleção de objetos como matrizes, cadeias multilinha ou coleções de geometrias

---

# 6.3 Classes sf

## Simple feature geometries (sfg)

```{r}
# vector - point
vec <- c(5, 2)
po <- sf::st_point(vec)
po
```

```{r , out.width='35%'}
# plot
plot(po, pch = 20, cex = 4, axes = TRUE, graticule = TRUE)
```

---

# 6.3 Classes sf

## Simple feature geometries (sfg)

```{r}
# matrix - multipoint
multipoint_matrix <- rbind(c(5, 2), c(1, 3), c(3, 4), c(3, 2))
po_mul <- sf::st_multipoint(multipoint_matrix)
po_mul
```

```{r , out.width='35%'}
# plot
plot(po_mul, pch = 20, cex = 4, axes = TRUE, graticule = TRUE)
```

---

# 6.3 Classes sf

## Simple feature geometries (sfg)

```{r}
# matrix - multipoint
multipoint_matrix <- rbind(c(5, 2), c(1, 3), c(3, 4), c(3, 2))
lin <- sf::st_linestring(multipoint_matrix)
lin
```

```{r , out.width='35%'}
# plot
plot(lin, lwd = 2, axes = TRUE, graticule = TRUE)
```

---

# 6.3 Classes sf

## Simple feature geometries (sfg)

```{r}
# list - polygon
polygon_list <- list(rbind(c(1, 5), c(2, 2), c(4, 1), c(4, 4), c(1, 5)))
pol <- sf::st_polygon(polygon_list)
pol
```

```{r , out.width='35%'}
# plot
plot(pol, col = "gray", axes = TRUE, graticule = TRUE)
```

---

# 6.3 Classes sf

## Simple feature columns (sfc)

### Uma **lista de objetos** `sfg` que possui o **mesmo CSR** (*Coordinate Reference System*)

--

### Pode conter objetos da **mesma geometria** ou de **geometrias diferentes**

--

### Funções para **criar** a classe `sfc` e verificar o **tipo da geometria e CRS**:
```{r eval=FALSE}
sf::st_sfc()
sf::st_geometry_type()
sf::st_crs()
```

---

# 6.3 Classes sf

## Simple feature columns (sfc)
```{r}
# sfc point
point1 <- sf::st_point(c(5, 2))
point2 <- sf::st_point(c(1, 3))
points_sfc <- sf::st_sfc(point1, point2)
points_sfc
```

```{r}
sf::st_geometry_type(points_sfc)
```

---

# 6.3 Classes sf

## Simple feature columns (sfc)
```{r , out.width='45%'}
# plot
plot(points_sfc, pch = 20, cex = 4, axes = TRUE, graticule = TRUE)
```

---

# 6.3 Classes sf

## Simple feature columns (sfc)
```{r}
# sfc geometry
po_pol_sfc <- sf::st_sfc(po, pol)
po_pol_sfc
```

```{r}
sf::st_geometry_type(po_pol_sfc)
```

---

# 6.3 Classes sf

## Simple feature columns (sfc)
```{r , out.width='45%'}
# plot
plot(po_pol_sfc, pch = 20, cex = 4, lwd = 2, col = "gray", axes = TRUE, graticule = TRUE)
```

---

# 6.3 Classes sf

## Simple feature columns (sfc)

### Coordinate Reference Systems (CRS) - EPSG
```{r}
# epsg definition
points_sfc_wgs <- sf::st_sfc(point1, point2, crs = 4326)
sf::st_crs(points_sfc_wgs)
```

---

# 6.3 Classes sf

## Simple feature columns (sfc)

### Coordinate Reference Systems (CRS) - proj4string
```{r}
# proj4string definition
points_sfc_wgs <- sf::st_sfc(point1, point2, crs = "+proj=longlat +datum=WGS84 +no_defs")
sf::st_crs(points_sfc_wgs)
```

---

# 6.3 Classes sf

## Simple feature columns (sfc)
```{r , out.width='45%'}
# plot
plot(points_sfc_wgs, pch = 20, cex = 4, axes = TRUE, graticule = TRUE)
```

---

# 6.3 Classes sf

## A classe sf

### A classe sf (simple features) são *data.frames* com **atributos espaciais** armazenados em uma coluna, geralmente chamada de **geometry** 

--

### Essa **dualidade** é central para o conceito de **simple features**: na maioria das vezes, um sf pode **ser tratado e se comporta** como um *data.frame *

--

### **Simple features** são, em essência, *data.frames* com uma **extensão espacial**

---

# 6.3 Classes sf

## A classe sf

### Criar um objeto sf
```{r}
rc_point <- sf::st_point(c(-47.57,-22.39))         # sfg object
rc_geom <- sf::st_sfc(rc_point, crs = 4326)        # sfc object
rc_attrib <- data.frame(                       # data.frame object
  name = "Rio Claro",
  temperature = 19,
  date = as.Date("2020-10-13")
)
rc_sf <- sf::st_sf(rc_attrib, geometry = rc_geom)  # sf object
```

---

# 6.3 Classes sf

## A classe sf

### A estrutura de um objeto sf
```{r}
rc_sf
```

### As duas classes do objeto sf
```{r}
class(rc_sf)
```

---

# 6.3 Classes sf

## A classe sf
```{r , out.width='45%'}
# plot
plot(rc_sf[1], pch = 20, cex = 4, axes = TRUE, graticule = TRUE) # rc_sf[1] - plotar a primeira coluna
```

---

# 6.3 Classes sf

## A classe sf
```{r , out.width='45%'}
# plot
plot(rc_sf[2], pch = 20, cex = 4, axes = TRUE, graticule = TRUE) # rc_sf[2] - plotar a segunda coluna
```

---

# 6.3 Classes sf

## A classe sf
```{r , fig.height=6.7, out.width='50%'}
# plot
plot(rc_sf$geometry, pch = 20, cex = 4, axes = TRUE, graticule = TRUE) # rc_sf$geometry - plotar apenas a geometria
```

---

class: inverse, center, middle

# Dúvidas?

---

class: inverse, center, middle

# Vamos começar fazendo o download de vetores pelo R

---

background-image: url(img/geo_data_fbds.png)
background-size: 500px
background-position: 50% 95%

# 6.4 Importar dados

### Fundação Brasileira Desenvolvimento Sustentável (FBDS)

Em 2015, a FBDS deu início ao *Projeto de Mapeamento em Alta Resoluçăo dos Biomas Brasileiros*: 
- Cobertura da terra
- Hidrografia (nascentes, rios e lagos)
- Áreas de Preservaçăo Permanente (APP)

O mapeamento foi concluído para os municípios dos biomas *Mata Atlântica e Cerrado*

Site: https://www.fbds.org.br/<br>
Repositório: http://geo.fbds.org.br/

---

# 6.4 Importar dados

## Download

### Criar um diretório 
```{r eval=FALSE}
# create directory
dir.create(here::here("03_dados", "vetor"))
```

--

### Download de **pontos de nascentes** para Rio Claro/SP
```{r eval=FALSE}
# increase time to download
options(timeout = 600)

# download lines
for(i in c(".dbf", ".prj", ".shp", ".shx")){
  download.file(url = paste0("http://geo.fbds.org.br/SP/RIO_CLARO/HIDROGRAFIA/SP_3543907_NASCENTES", i),
                destfile = here::here("03_dados", "vetor", paste0("SP_3543907_NASCENTES", i)), mode = "wb")
}
```

---

# 6.4 Importar dados

## Download

### Download de **linhas da hidrografia** para Rio Claro/SP
```{r eval=FALSE}
# download lines
for(i in c(".dbf", ".prj", ".shp", ".shx")){
  download.file(url = paste0("http://geo.fbds.org.br/SP/RIO_CLARO/HIDROGRAFIA/SP_3543907_RIOS_SIMPLES", i),
                destfile = here::here("03_dados", "vetor", paste0("SP_3543907_RIOS_SIMPLES", i)), mode = "wb")
}
```

### Download de **polígonos de cobertura da terra** para Rio Claro/SP
```{r eval=FALSE}
# download polygon
for(i in c(".dbf", ".prj", ".shp", ".shx")){
  download.file(url = paste0("http://geo.fbds.org.br/SP/RIO_CLARO/USO/SP_3543907_USO", i),
                destfile = here::here("03_dados", "vetor", paste0("SP_3543907_USO", i)), mode = "wb")
}
```

---

class: inverse, center, middle

# Importar dados preexistentes

---

# 6.4 Importar dados

## Dados preexistentes
```{r}
# import points
rc_spr <- sf::st_read(here::here("03_dados", "vetor", "SP_3543907_NASCENTES.shp"), quiet = TRUE)
rc_spr
```

---

# 6.4 Importar dados

## Dados preexistentes
```{r , out.width='50%'}
# plot
plot(rc_spr$geometry, pch = 20, col = "blue", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados preexistentes
```{r}
# import lines
rc_riv <- sf::st_read(here::here("03_dados", "vetor", "SP_3543907_RIOS_SIMPLES.shp"), quiet = TRUE)
rc_riv
```

---

# 6.4 Importar dados

## Dados preexistentes
```{r , out.width='50%'}
# plot
plot(rc_riv$geometry, col = "steelblue", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados preexistentes
```{r}
# import polygons
rc_use <- sf::st_read(here::here("03_dados", "vetor", "SP_3543907_USO.shp"), quiet = TRUE)
rc_use
```

---

# 6.4 Importar dados

## Dados preexistentes
```{r , out.width='45%'}
# plot
plot(rc_use[5], col = c("blue", "orange", "gray30", "forestgreen", "green"), main = NA, axes = TRUE, graticule = TRUE)
```

---

class: inverse, center, middle

# Importar dados de GPS

---

class: inverse, center, middle

# Um agradecimento ao Rafael (Urucum), que gentilmente cedeu os dados `r icon::fa_grin_beam_sweat()`

---

# 6.4 Importar dados

## Dados de GPS (.gpx)
```{r}
# import gps data
gps_gpx <- sf::read_sf(here::here("03_dados", "vetor", "waypoints.gpx"), layer = "waypoints")
gps_gpx
```

---

# 6.4 Importar dados

## Dados de GPS (.gpx)
```{r , out.width='50%'}
# plot
plot(gps_gpx$geometry, cex = 4, pch = 20, col = "red", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados de GPS (.kml)
```{r}
# import gps data
gps_kml <- sf::read_sf(here::here("03_dados", "vetor", "waypoints.kml"))
gps_kml
```

---

# 6.4 Importar dados

## Dados de GPS (.kml)
```{r , out.width='50%'}
# plot
plot(gps_kml$geometry, cex = 4, pch = 20, col = "red", main = NA, axes = TRUE, graticule = TRUE)
```

---

class: inverse, center, middle

# Importar dados de pacotes

---

background-image: url(img/package_geobr02.png)
background-size: 300px
background-position: 50% 70%

# 6.4 Importar dadosf

## Dados de pacotes: geobr
```{r eval=FALSE}
install.packages("geobr")
library(geobr)
```

<br><br><br><br><br><br><br><br><br><br><br><br>

[*] https://github.com/ipeaGIT/geobr

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r message=FALSE, warning=FALSE}
# brazil 2019
br_2019 <- geobr::read_country(year = 2019, showProgress = FALSE)
br_2019
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r , out.width='50%'}
# plot
plot(br_2019$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r}
# brazil 1872
br_1872 <- geobr::read_country(year = 1872, showProgress = FALSE)
br_1872
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr

```{r , out.width='50%'}
# plot
plot(br_1872$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r}
# sao paulo state
sp_2019 <- geobr::read_state(code_state = "SP", year = 2019, showProgress = FALSE)
sp_2019
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r , out.width='50%'}
# plot
plot(sp_2019$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r}
# sao paulo municipalities
sp_mun_2019 <- geobr::read_municipality(code_muni = "SP", year = 2019, showProgress = FALSE)
sp_mun_2019
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r , out.width='50%'}
# plot
plot(sp_mun_2019$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r}
# rio claro
rc_2019 <- geobr::read_municipality(code_muni = 3543907, year = 2019, showProgress = FALSE)
rc_2019
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r , out.width='50%'}
# plot
plot(rc_2019$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r}
# biomes
bi_2019 <- geobr::read_biomes(year = 2019, showProgress = FALSE)
bi_2019
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr
```{r , out.width='50%'}
# plot
plot(bi_2019$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados de pacotes: geobr

<br>

|Function|Geographies available|Years available|Source|
|-----|-----|-----|-----|
|`read_country()`| Country | 1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991, 2000, 2001, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019 | IBGE |
|`read_state()`| States | 1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991, 2000, 2001, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019 | IBGE |
|`read_municipality()`| Municipality | 1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991, 2000, 2001, 2005, 2007, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019 | IBGE | 
|`read_biomes()`| Biomes | 2004, 2019 | IBGE | 

---

# 6.4 Importar dados

## Dados de pacotes: geobr

```{r}
# list all datasets available in the geobr package
geobr::list_geobr()
```

---

background-image: url(img/package_ropensci.png)
background-size: 500px
background-position: 50% 55%

# 6.4 Importar dados

## Dados de pacotes: rnaturalearth
```{r eval=FALSE}
# package
install.packages("rnaturalearth")
library(rnaturalearth)
```

<br><br><br><br><br><br><br><br><br>

[*] http://www.naturalearthdata.com/ 

[*] https://docs.ropensci.org/rnaturalearth/

---

# 6.4 Importar dados

## Dados de pacotes: rnaturalearth
```{r}
# south america
sa <- rnaturalearth::ne_countries(scale = "small", continent = "South America", returnclass = "sf")
sa
```

---

# 6.4 Importar dados

## Dados de pacotes: rnaturalearth
```{r , out.width='50%'}
# plot
plot(sa$geometry, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.4 Importar dados

## Dados de pacotes: rnaturalearth
```{r}
# coast lines
coastline <- rnaturalearth::ne_coastline(scale = "small", returnclass = "sf")
coastline
```

---

# 6.4 Importar dados

## Dados de pacotes: rnaturalearth
```{r , fig.height=4, out.width='100%'}
# plot
plot(coastline$geometry, col = "blue", main = NA)
```

---

class: inverse, center, middle

# Descrição de objetos sf

---

# 6.5 Descrição de objetos sf

## Informações geográficas e tabela de atributos
```{r}
# south america
sa
```

---

# 6.5 Descrição de objetos sf

## Informações geográficas

### Geometry type
```{r}
# geometry
sf::st_geometry_type(sa)
```

--

### Bounding box
```{r}
# extention
sf::st_bbox(sa)
```

---

# 6.5 Descrição de objetos sf

## Informações geográficas

### Coordinate reference system
```{r}
# coordinate reference system
sf::st_crs(sa)
```

---

background-image: url(img/geo_vector_attribute_table.png)
background-size: 450px
background-position: 45% 80%

# 6.5 Descrição de objetos sf

## Tabela de atributos

### Relação entre a geometria e suas características

---

# 6.5 Descrição de objetos sf

## Tabela de atributos

### Acessar a tabela de atributos de um `sf`
```{r}
# acessar a tabela de atributos
sa_tab <- sf::st_drop_geometry(sa)
sa_tab
```

```{r}
# classe
class(sa_tab)
```

---

class: inverse, center, middle

# Importar dados de planilhas eletrônicas e converter em sf

---

# 6.6 Converter dados sf

## Dados de uma planilha eletrônica
```{r message=FALSE}
# import table
si <- readr::read_csv(here::here("03_dados", "tabelas", "ATLANTIC_AMPHIBIANS_sites.csv"))
si
```

---

# 6.6 Converter dados sf

## Add as duas colunas de `lon` e `lat`
```{r}
# add column
si <- si %>% 
  dplyr::mutate(lon = longitude, lat = latitude, .before = 1)
si
```

---

# 6.6 Converter dados sf

## Converter dados de planilhas em sf
```{r}
# convert to sf
si_ve <- si %>% 
  sf::st_as_sf(coords = c("lon", "lat"), crs = 4326)
si_ve
```

---

# 6.6 Converter dados sf

## Converter dados de planilhas em sf
```{r , out.width='50%'}
# plot
plot(si_ve$geometry, pch = 20, main = NA, axes = TRUE, graticule = TRUE)
```

---

background-image: url(img/geo_sp.png),url(img/geo_sp_dep.png)
background-size: 250px,700px
background-position: 90% 18%,50% 95%

# 6.6 Converter dados sf

## Tipos de objetos `sp`
- SpatialPoints 
- SpatialLines
- SpatialPolygons
- SpatialPointsDataFrame
- SpatialLinesDataFrame
- SpatialPolygonsDataFrame

---

# 6.6 Converter dados sf

## Dados `sp`
```{r}
# countries sp
co110_sp <- rnaturalearth::countries110
co110_sp
```

---

# 6.6 Converter dados sf

## Converter `sp` para `sf`
```{r}
# countries sf
co110_sf <- sf::st_as_sf(co110_sp)
co110_sf
```

---

# 6.6 Converter dados sf

## Converter `sf` para `sp`
```{r , fig.height=4, out.width='90%'}
# plot
plot(co110_sf$geometry, col = "gray", main = NA, graticule = TRUE)
```

---

# 6.6 Converter dados sf

## Converter `sf` para `sp`
```{r}
# countries sp
co110_sp <- sf::as_Spatial(co110_sf)
co110_sp
```

---

class: inverse, center, middle

# Conversão do CRS

---

background-image: url(img/geo_proj_sirgas2000.png)
background-size: 200px
background-position: 50% 75%

# 6.7 Conversão do CRS

## Converter CRS local

### SIRGAS2000/GCS -> SIRGAS2000/UTM23S
```{r}
# convert coordinate system
rc_2019_sirgas2000_utm23s <- sf::st_transform(rc_2019, crs = 31983)
```

<br><br><br><br><br><br><br><br>

[*] https://epsg.io/31983

[*] http://www.sirgas.org/pt/sirgas-realizations/sirgas2000/

---

# 6.7 Conversão do CRS

## Converter CRS local

### plota
```{r echo=FALSE, , fig.height=4, out.width='80%'}
library(tidyverse)
p1 <- ggplot() +
  geom_sf(data = rc_2019) +
  coord_sf(datum = sf::st_crs(4674)) +
  labs(x = "Longitude", y = "Latitude", title = "SIRGAS2000/GCS") + 
  theme_bw() +
  theme(axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 7, angle = 90, hjust = .5),
        panel.grid = element_line(size = .3, color = "black", linetype = 2))

p2 <- ggplot() +
  geom_sf(data = rc_2019) +
  coord_sf(datum = sf::st_crs(31983)) +
  labs(x = "X", y = "Y", title = "SIRGAS2000/UTM23S") + 
  theme_bw() +
  theme(axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 7, angle = 90, hjust = .5),
        panel.grid = element_line(size = .3, color = "black", linetype = 2))

gridExtra::grid.arrange(p1, p2, nrow = 1)
```

---

background-image: url(img/geo_utm_zones.png)
background-size: 400px
background-position: 50% 65%

# 6.7 Conversão do CRS

## Converter CRS local

### SIRGAS2000/GCS -> WGS84/UTM23S
```{r}
# convert datum and coordinate system
rc_2019_wgs84_utm23s <- sf::st_transform(rc_2019, crs = 32723)
```

<br><br><br><br><br><br><br><br>

[*] https://epsg.io/32723

[*] https://pro.arcgis.com/en/pro-app/help/mapping/properties/transverse-mercator.htm

---

background-image: url(img/geo_geographic.png)
background-size: 400px
background-position: 50% 70%

# 6.7 Conversão do CRS

## Converter CRS local

### SIRGAS2000/GCS -> WGS84/GCS
```{r}
# convert datum
rc_2019_wgs84_gcs <- sf::st_transform(rc_2019, crs = 4326)
```

<br><br><br><br><br><br><br><br><br>

[*] https://epsg.io/4326

---

# 6.7 Conversão do CRS

## Converter CRS global
```{r}
# countries - WGS84/GCS
co110_sf
```

---

# 6.7 Conversão do CRS

## Converter CRS global
```{r , fig.height=4, out.width='90%'}
# plot
plot(co110_sf$geometry, col = "gray", graticule = TRUE)
```

---

background-image: url(img/geo_proj_moll.png)
background-size: 450px
background-position: 50% 70%

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção de Mollweide: preserva as relações de área
```{r}
# mollweide projection
co110_sf_moll <- sf::st_transform(co110_sf, crs = "+proj=moll")
```

<br><br><br><br><br><br><br><br>

[*] https://epsg.io/54009

[*] https://pro.arcgis.com/en/pro-app/help/mapping/properties/mollweide.htm

---

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção de Mollweide
```{r , fig.height=4, out.width='90%'}
# plot
plot(co110_sf_moll$geometry, col = "gray", graticule = TRUE)
```

---

background-image: url(img/geo_proj_wintri.png)
background-size: 400px
background-position: 50% 75%

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção de Winkel Tripel: mínimo de distorção para área, direção e distância
```{r}
# winkel tripel projection
co110_sf_wintri <- lwgeom::st_transform_proj(co110_sf, crs = "+proj=wintri")
```

<br><br><br><br><br><br><br><br>

[*] https://pro.arcgis.com/en/pro-app/help/mapping/properties/winkel-tripel.htm

---

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção de Winkel Tripel
```{r , fig.height=4, out.width='90%'}
# plot
plot(co110_sf_wintri$geometry, col = "gray")
```

---

background-image: url(img/geo_proj_eck4.png)
background-size: 400px
background-position: 50% 70%

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção de Eckert IV: presenva a área e com meridianos elípticos
```{r}
# eckert iv projection
co110_sf_eck4 <- sf::st_transform(co110_sf, crs = "+proj=eck4")
```

<br><br><br><br><br><br><br>

[*] https://epsg.io/54012

[*] https://pro.arcgis.com/en/pro-app/help/mapping/properties/eckert-iv.htm

---

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção de Eckert IV
```{r , fig.height=4, out.width='90%'}
# plot
plot(co110_sf_eck4$geometry, col = "gray", graticule = TRUE)
```

---

background-image: url(img/geo_proj_laea.png)
background-size: 200px
background-position: 50% 70%

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção azimutal de Lambert: preserva os tamanhos relativos e senso de direção a partir do centro
```{r}
# lambert projection
co110_sf_laea1 <- sf::st_transform(co110_sf, crs = "+proj=laea +x_0=0 +y_0=0 +lon_0=0 +lat_0=0")
```

<br><br><br><br><br><br><br>

[*] https://pro.arcgis.com/en/pro-app/help/mapping/properties/lambert-azimuthal-equal-area.htm

---

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção azimutal de Lambert
```{r , fig.height=4, out.width='90%'}
# plot
plot(co110_sf_laea1$geometry, col = "gray", graticule = TRUE)
```

---

background-image: url(img/geo_proj_laea.png)
background-size: 200px
background-position: 50% 70%

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção azimutal de Lambert: preserva os tamanhos relativos e senso de direção a partir do centro
```{r}
# lambert projection
co110_sf_laea2 <- sf::st_transform(co110_sf, crs = "+proj=laea +x_0=0 +y_0=0 +lon_0=-50 +lat_0=0")
```

<br><br><br><br><br><br><br>

[*] https://pro.arcgis.com/en/pro-app/help/mapping/properties/lambert-azimuthal-equal-area.htm

---

# 6.7 Conversão do CRS

## Converter CRS global

### Projeção azimutal de Lambert
```{r , fig.height=4, out.width='90%'}
# plot
plot(co110_sf_laea2$geometry, col = "gray", graticule = TRUE)
```

---

class: inverse, center, middle
# Manipulação e análise de dados vetoriais

---

# 6.8 Operações de atributos

## Modificação de objetos espaciais baseado em **informações não espaciais** associadas a dados geográficos

### Operações:
1. Subset de atributos
1. Join de atributos 
1. Aggregation de atributos
1. Criação de atributos
1. Outros operações

---

# 6.8 Operações de atributos

## 1. Subset de atributos
```{r message=FALSE}
# 1. attribute subsetting
rc_use_forest <- rc_use %>% 
  dplyr::filter(CLASSE_USO == "formação florestal")
rc_use_forest
```

---

# 6.8 Operações de atributos

## 1. Subset de atributos
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_use_forest$geometry, col = "forestgreen", add = TRUE)
```

---

# 6.8 Operações de atributos

## 2. Join de atributos 
```{r}
# 2. attribute joining - create data
da_class <- tibble::tibble(CLASSE_USO = rc_use$CLASSE_USO, 
                           classe = c("agua", "antropico", "edificado", "floresta", "silvicultura"))
da_class
```

---

# 6.8 Operações de atributos

## 2. Join de atributos 
```{r}
# 2. attribute joining - join
rc_use_class <- dplyr::left_join(rc_use, da_class, by = "CLASSE_USO") %>% 
  sf::st_drop_geometry()
rc_use_class
```

---

# 6.8 Operações de atributos

## 3. Aggregation de atributos
```{r}
# 3. attribute aggregation
rc_spr_n <- rc_spr %>% 
  dplyr::group_by(MUNICIPIO, HIDRO) %>% 
  dplyr::summarise(n = n())
rc_spr_n
```

---

# 6.8 Operações de atributos

## 3. Aggregation de atributos
```{r , out.width='50%'}
# plot 
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_spr_n$geometry, pch = 20, col = "blue", add = TRUE)
```

---

# 6.8 Operações de atributos

## 4. Criação de atributos
```{r}
# 4. attribute create - columns
rc_use_use_area <- rc_use %>% 
  dplyr::mutate(classe_area = paste0(CLASSE_USO, " (", AREA_HA, " ha)")) %>% 
  sf::st_drop_geometry()
rc_use_use_area
```

---

# 6.8 Operações de atributos

## 4. Criação de atributos
```{r}
# 4. attribute create - area
rc_use_area <- rc_use %>% 
  dplyr::mutate(area_m2 = sf::st_area(rc_use),
                area_ha = sf::st_area(rc_use)/1e4) %>% 
  sf::st_drop_geometry()
rc_use_area
```

---

# 6.8 Operações de atributos

## 5. Outros operações: funções do `dplyr` para manipulação de feições
```{r eval=FALSE}
dplyr::filter()
dplyr::distinc()
dplyr::slice()
dplyr::n_sample()
dplyr::group_by()
dplyr::summarise()
```

---

# 6.8 Operações de atributos

## 5. Outros operações: funções do `dplyr` para manipulação da tabela de atributos
```{r eval=FALSE}
dplyr::select()
dplyr::pull()
dplyr::rename()
dplyr::mutate()
dplyr::arrange()
dplyr::*_join()
```

---

class: inverse, center, middle
# Operações espaciais

---

# 6.9 Operações espaciais

## Modificação de objetos espaciais baseado na sua **localização e formato**

### Operações:
1. Subset espacial
1. Join espacial
1. Pontos aleatórios
1. Quadrículas
1. Hexágonos

---

# 6.9 Operações espaciais

## 1. Subset espacial
```{r}
# spatial subsetting
sf::st_intersects(x = rc_spr, y = rc_use_forest)
```

---

# 6.9 Operações espaciais

## 1. Subset espacial
```{r}
# spatial subsetting
sf::st_intersects(x = rc_spr, y = rc_use_forest, sparse = FALSE)
```

---

# 6.9 Operações espaciais

## 1. Subset espacial - dentro
```{r}
# spatial subsetting - inside
rc_spr_forest <- rc_spr %>% 
  dplyr::filter(sf::st_intersects(x = ., y = rc_use_forest, sparse = FALSE))
rc_spr_forest
```

---

# 6.9 Operações espaciais

## 1. Subset espacial [] - dentro
```{r}
# spatial subsetting - inside
rc_spr_forest <- rc_spr[rc_use_forest, ]
rc_spr_forest
```

---

# 6.9 Operações espaciais

## 1. Subset espacial [] - dentro
```{r out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_use_forest$geometry, col = "forestgreen", add = TRUE)
plot(rc_spr_forest$geometry, col = "blue", pch = 20, cex = 1, add = TRUE)
```

---

# 6.9 Operações espaciais

## 1. Subset espacial - fora
```{r}
# spatial subsetting - outside
rc_spr_forest_out <- rc_spr %>% 
  dplyr::filter(!sf::st_intersects(x = ., y = rc_use_forest, sparse = FALSE))
rc_spr_forest_out
```

---

# 6.9 Operações espaciais

## 1. Subset espacial - fora
```{r , out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_use_forest$geometry, col = "forestgreen", add = TRUE)
plot(rc_spr_forest_out$geometry, col = "steelblue", pch = 20, cex = 1, add = TRUE)
plot(rc_spr_forest$geometry, col = "blue", pch = 20, cex = 1, add = TRUE)
```

---

# 6.9 Operações espaciais

## 2. Join espacial
```{r}
# 2. spatial join
rc_spr_use <- rc_spr %>% 
  sf::st_join(x = ., y = rc_use)
rc_spr_use
```

---

# 6.9 Operações espaciais

## 2. Join espacial
```{r}
# 2. spatial join
rc_spr_use %>% 
  sf::st_drop_geometry() %>% 
  dplyr::count(CLASSE_USO)
```

---

# 6.9 Operações espaciais

## 2. Join de atributos
```{r}
# 2. attribute join
col <- tibble::tibble(CLASSE_USO = c("água", "área antropizada", "área edificada", "formação florestal", "silvicultura"),
                      color = c("blue", "orange", "gray30", "forestgreen", "green"))
col
```

---

# 6.9 Operações espaciais

## 2. Join de atributos
```{r}
# 2. attribute join
rc_spr_use <- dplyr::left_join(rc_spr_use, col, by = "CLASSE_USO")
rc_spr_use
```

---

# 6.9 Operações espaciais

## 2. Join espacial
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_spr_use[10], col = rc_spr_use$color, pch = 20, add = TRUE)
```

---

# 6.9 Operações espaciais

## 3. Pontos aleatórios
```{r}
# 3. random points
rc_2019_sirgas2000_utm23s_rp <- sf::st_sample(rc_2019_sirgas2000_utm23s, 1e3)
rc_2019_sirgas2000_utm23s_rp
```

---

# 6.9 Operações espaciais

## 3. Pontos aleatórios
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2019_sirgas2000_utm23s_rp, pch = 20, cex = .5, col = "red", add = TRUE)
```

---

# 6.9 Operações espaciais

## 3. Pontos aleatórios
```{r}
# 3. random points
rc_use_forest_rp <- sf::st_sample(rc_use_forest, 1e3)
rc_use_forest_rp
```

---

# 6.9 Operações espaciais

## 3. Pontos aleatórios
```{r , out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_use_forest$geom, col = "forestgreen", add = TRUE)
plot(rc_use_forest_rp, pch = 20, cex = .5, col = "red", add = TRUE)
```

---

# 6.9 Operações espaciais

## 4. Quadrículas
```{r}
# 4. grid
rc_2019_sirgas2000_utm23s_grid <- rc_2019_sirgas2000_utm23s %>% 
  sf::st_make_grid(cellsize = 2000) %>% 
  sf::st_as_sf()
rc_2019_sirgas2000_utm23s_grid
```

---

# 6.9 Operações espaciais

## 4. Quadrículas
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2019_sirgas2000_utm23s_grid, col = adjustcolor("red", .1), add = TRUE)
```

---

# 6.9 Operações espaciais

## 4. Quadrículas
```{r}
# 4. grid - subset
rc_2019_sirgas2000_utm23s_grid_in <- rc_2019_sirgas2000_utm23s_grid[rc_2019_sirgas2000_utm23s, ]
rc_2019_sirgas2000_utm23s_grid_in
```

---

# 6.9 Operações espaciais

## 4. Quadrículas
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2019_sirgas2000_utm23s_grid_in, col = adjustcolor("red", .1), add = TRUE)
```

---

# 6.9 Operações espaciais

## 4. Quadrículas
```{r}
# 4. grid - count spring by cell
rc_2019_sirgas2000_utm23s_grid_in_spr_count <- rc_2019_sirgas2000_utm23s_grid_in %>% 
  dplyr::mutate(n = sf::st_intersects(x = ., rc_spr) %>% lengths())
rc_2019_sirgas2000_utm23s_grid_in_spr_count
```

---

# 6.9 Operações espaciais

## 4. Quadrículas
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s_grid_in_spr_count["n"], main = NA, axes = TRUE, graticule = TRUE)
```

---

# 6.9 Operações espaciais

## 5. Hexágonos
```{r}
# 5. hexagon
rc_2019_sirgas2000_utm23s_hex <- rc_2019_sirgas2000_utm23s %>% 
  sf::st_make_grid(cellsize = 2000, square = FALSE) %>% 
  sf::st_as_sf()
rc_2019_sirgas2000_utm23s_hex
```

---

# 6.9 Operações espaciais

## 5. Hexágonos
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2019_sirgas2000_utm23s_hex, col = adjustcolor("blue", .1), add = TRUE)
```

---

# 6.9 Operações espaciais

## 5. Hexágonos
```{r}
# 5. hexagon - count spring by hexagon
rc_2019_sirgas2000_utm23s_hex_spr_count <- rc_2019_sirgas2000_utm23s_hex %>% 
  dplyr::mutate(n = sf::st_intersects(x = ., rc_spr) %>% lengths())
rc_2019_sirgas2000_utm23s_hex_spr_count
```

---

# 6.9 Operações espaciais

## 5. Hexágonos
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s_hex_spr_count["n"], main = NA, axes = TRUE, graticule = TRUE)
```

---

class: inverse, center, middle
# Operações geométricas

---

# 6.10 Operações geométricas

## Modificação de objetos espaciais baseado em operações que mudam a **geometria do vetor**

### Operações:
1. Simplificação
1. Centroides
1. Buffers
1. União (Dissolve)
1. Corte (Clip)

---

# 6.10 Operações geométricas

## 1. Simplificação
```{r}
# 1. simplification
rc_riv_simp <- sf::st_simplify(rc_riv, dTolerance = 1e4)
rc_riv_simp
```

---

# 6.10 Operações geométricas

## 1. Simplificação
```{r , out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_riv$geometry, col = "steelblue", add = TRUE)
plot(rc_riv_simp$geometry, col = adjustcolor("red", .7), add = TRUE)
```

---

# 6.10 Operações geométricas

## 2. Centroides
```{r}
# 2. centroids
rc_2019_cent <- sf::st_centroid(rc_2019_sirgas2000_utm23s)
rc_2019_cent
```

---

# 6.10 Operações geométricas

## 2. Centroides
```{r , out.width='50%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2019_cent$geom, cex = 3, col = "red", pch = 20, add = TRUE)
```

---

# 6.10 Operações geométricas

## 2. Centroides
```{r}
# 2. centroids
rc_2019_sirgas2000_utm23s_hex_cent <- sf::st_centroid(rc_2019_sirgas2000_utm23s_hex)
rc_2019_sirgas2000_utm23s_hex_cent
```

---

# 6.10 Operações geométricas

## 2. Centroides
```{r , out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2019_sirgas2000_utm23s_hex, col = adjustcolor("blue", .1), add = TRUE)
plot(rc_2019_sirgas2000_utm23s_hex_cent, col = "blue", pch = 20, add = TRUE)
```

---

# 6.10 Operações geométricas

## 3. Buffer
```{r}
# 3. buffer
rc_spr_forest_buf <- rc_spr_forest %>% 
  sf::st_buffer(dist = 500)
rc_spr_forest_buf
```

---

# 6.10 Operações geométricas

## 3. Buffer
```{r , out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_spr_forest$geom, pch = 20, cex = .5, col = "blue", add = TRUE)
plot(rc_spr_forest_buf$geom, col = adjustcolor("white", 0), add = TRUE)
```

---

# 6.10 Operações geométricas

## 4. União (Dissolve)
```{r}
# 4. union
rc_spr_forest_buf_union <- sf::st_union(rc_spr_forest_buf)
rc_spr_forest_buf_union
```

---

# 6.10 Operações geométricas

## 4. União (Dissolve)
```{r , out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_spr_forest$geom, pch = 20, cex = .5, col = "blue", add = TRUE)
plot(rc_spr_forest_buf_union, col = adjustcolor("white", 0), add = TRUE)
```

---

# 6.10 Operações geométricas

## 5. Corte (Clip) - intersecção
```{r}
# 5. clipping - intersection
rc_riv_spr_forest_buf_int <- sf::st_intersection(x = rc_riv, y = rc_spr_forest_buf_union)
rc_riv_spr_forest_buf_int
```

---

# 6.10 Operações geométricas

## 5. Corte (Clip) - intersecção
```{r , out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_spr_forest_buf_union, col = adjustcolor("blue", .1), add = TRUE)
plot(rc_riv_spr_forest_buf_int$geometry, col = "blue", add = TRUE)

```

---

# 6.10 Operações geométricas

## 5. Corte (Clip) - diferença
```{r}
# 5. clipping - difference
rc_riv_spr_forest_buf_dif <- sf::st_difference(x = rc_riv, y = rc_spr_forest_buf_union)
rc_riv_spr_forest_buf_dif
```

---

# 6.10 Operações geométricas

## 5. Corte (Clip)
```{r , out.width='45%'}
# plot
plot(rc_2019_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_spr_forest_buf_union, col = adjustcolor("blue", .1), add = TRUE)
plot(rc_riv_spr_forest_buf_dif$geometry, col = "blue", add = TRUE)
```

---

class: inverse, center, middle
# Exportar dados

---

background-image: url(img/geo_shp_logo.png),url(img/geo_shp_formats.png)
background-size: 150px,450px
background-position: 50% 60%,50% 90%

# 6.11 Exportar dados

## Exportar como shapefile
```{r eval=FALSE}
# export shapefile
sf::st_write(obj = rc_spr_forest_buf, 
             dsn = here::here("03_dados", "vetor", "rc_spr_forest_buf.shp"),
             layer = "rc_spr_forest_buf.shp",
             driver = "ESRI Shapefile")
```

---

background-image: url(img/geo_ban_shp.png),url(img/geo_geopackage.png)
background-size: 200px,500px
background-position: 13% 60%,90% 70%

# 6.11 Exportar dados

## Exportar como geopackage
```{r eval=FALSE}
# export geopackage
sf::st_write(obj = rc_spr_forest_buf, 
             dsn = here::here("03_dados", "vetor", "rc_spr_forest_buf.gpkg"),
             layer = "rc_spr_forest_buf")
```

<br><br><br><br><br><br><br><br>

[*] http://switchfromshapefile.org/

[*] https://jsta.rbind.io/blog/2016-07-14-geopackage-r/

---

background-image: url(img/geo_ban_shp.png),url(img/geo_geopackage.png)
background-size: 200px,500px
background-position: 13% 60%,90% 70%

# 6.11 Exportar dados

## Exportar como geopackage
```{r eval=FALSE}
# export geopackage
sf::st_write(obj = rc_spr_forest_buf_union, 
             dsn = here::here("03_dados", "vetor", "rc_spr_forest_buf.gpkg"),
             layer = "rc_spr_forest_buf_union")

```

<br><br><br><br><br><br><br><br>

[*] http://switchfromshapefile.org/

[*] https://jsta.rbind.io/blog/2016-07-14-geopackage-r/

---

class: inverse, middle, center

# Dúvidas?

---

class: clear, middle

## Maurício Vancine

<br>

Contatos:

`r icon::fa_envelope(colour = "#0000ee")` [mauricio.vancine@gmail.com]()
<br>
`r icon::fa_twitter(colour = "#0000ee")` [@mauriciovancine](https://twitter.com/mauriciovancine)
<br>
`r icon::fa_github(colour = "#0000ee")` [mauriciovancine](https://mauriciovancine.netlify.com/)
<br>
`r icon::fa_link(colour = "#0000ee")` [mauriciovancine.netlify.com](https://mauriciovancine.netlify.com/)

Slides criados via pacote [xaringan](https://github.com/yihui/xaringan) e tema [Metropolis](https://github.com/pat-s/xaringan-metropolis)